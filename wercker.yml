box: erlang:18

build:
    steps:
      - script:
        name: generate service
        code: |
            mkdir -p ~/.config/rebar3/templates
            cp -rv ./* ~/.config/rebar3/templates
            rebar3 new erlang-service name=snakeoil
      - script:
        name: start it
        code: |
            cd snakeoil
            make start
      - script:
        name: xref it
        code: |
            cd snakeoil
            make xref
      - script:
        name: dialyze it
        code: |
            cd snakeoil
            make dialyze
      - script:
        name: test it
        code: |
            cd snakeoil
            make test
    after-steps:
      - slack-notifier:
        url: ${SLACK_WEBHOOK_URL}
        username: "wercker"
